{% extends "navPage.html" %}
{% load static %}

{% block title %}{% if query %}{{ query }} - {% endif %}AMELA Media Search{% endblock %}

{% block content %}

	<div class="form-style" style="margin: 0;padding-left: 40px;padding-bottom: 40px;width: 200%;">
		<form action="{% url 'streaming:search' %}" method="get" style="display: inline-block;">
			<input style="width: 300px;" class="searchfield" id="searchbox" name="Title" type="text" placeholder="Search for Movies and Shows" value="{{ query }}">
			<input type="submit" value="Search">
		</form>

		<button id="popup-btn" style="background: none;" onclick="openPopUp()">Filter Search</button>

		<div id="popup" class="popup-style">
			<div class="popup-style-content">
				<span class="close">&times;</span>
				<form action="{% url 'streaming:search' %}" method="get">
					<p>Filter Search</p>
					<input style="width: 300px;" class="searchfield" id="searchbox" name="Title" type="text" placeholder="Search for Movies and Shows" value="{{ query }}">
					<input type="submit" value="Search">
						<h2>
						{% for filter in filters %}
							{% if filter.name != "Title" %}
								{{ filter.name }}: <input style="width: 100px;margin-right: 20px;" id="{{ filter.name }}" list="{{ filter.name }}-list" autocomplete=off placeholder="{{ filter.name }}" value="{{ filter.value}}" type="text" name="{{ filter.name }}">
									<datalist id="{{ filter.name }}-list">
									{% for option in filter.defaults %}
										<option>{{ option }}</option>
									{% endfor %}
									</datalist>
							{% endif %}
						{% endfor %}
						</h2>
				</form>
	    	</div>
		</div>
	</div>

	{% if media %}
		<h1 id="search">
			{{ count }} result{{ count|pluralize }} found:
		</h1>
		<div class="media-style">

			{% for entry in media %}
			<figure>
				<a href="{% url 'streaming:display_media' title=entry.title %}"><img src="{% static "streaming/images/"|add:entry.thumbnail_path %}">{{ entry.title }}</a><br><br>
			</figure>
			{% endfor %}

		</div>
	{% else %}
		<h1 id="search">
			No results found for '<span style="color: #ffd700;">{{ query }}</span>'.
		</h1>
	{% endif %}
	<br><br><br>
	{% if media.paginator.num_pages > 1 %}
		<hr>
		<div class="pagination center">
			<span class="step-links">
				{% if media.has_previous %}
						<a href="?q={{ query }}&p=1">&laquo; first</a>
						<span>&#8226;</span>
						<a href="?q={{ query }}&p={{ media.previous_page_number }}">previous</a>
				{% endif %}

				<span>
						Page {{ media.number }} of {{ media.paginator.num_pages }}
				</span>

				{% if media.has_next %}
						<a href="?q={{ query }}&p={{ media.next_page_number }}">next</a>
						<span>&#8226;</span>
						<a href="?q={{ query }}&p={{ media.paginator.num_pages }}">last &raquo;</a>
				{% endif %}
			</span>
		</div>
	{% endif %}
{% endblock %}
