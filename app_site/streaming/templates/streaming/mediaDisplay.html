{% extends "navPage.html" %}
{% load static %}

{% block title %}{{ media.title }} - AMELA{% endblock %}
{% block description %}{{ media.description|truncatechars:300 }}{% endblock %}


{% block content %}
	<header>{{ media.title }} <span>({{ media.metadata.release_year }})</span></header><br>

	<aside>
		<fieldset style="border: 0">
			<legend>Rating:<div class="stars-outer"><div class="stars-inner" style="width: {{ avg_rating_perc }}%;"></div></div> ({{ num_ratings }} rating{{ num_ratings|pluralize }})</legend><br>
				<img id="photo" src="{% static "streaming/images/"|add:media.thumbnail_path %}"><br><br>
			{% if not episodes %}
			<div class="form-style" style="width: 100%;text-align: center;">
                <form action="{% url 'streaming:watch_media' title=media.title%}">
                    <input type="submit" value="WATCH" style="font-size: 20px;">
                </form>
            </div>
			{% endif %}
		</fieldset>
		<br><br>
		<fieldset>
			<legend style="text-align: center;">Leave a Rating</legend><br>
			<div class="form-style" style="text-align: center;">
                <form action="{% url 'streaming:post_rating' %}" method="post" onsubmit="submitOnce('submit', 'sending')">
					{% csrf_token %}
					<div class="rating">
						 <input type="radio" name="rating" id="star5" value="5">
						 <label for="star5"></label>
						 <input type="radio" name="rating" id="star4" value="4">
						 <label for="star4"></label>
						 <input type="radio" name="rating" id="star3" value="3">
						 <label for="star3"></label>
						 <input type="radio" name="rating" id="star2" value="2">
						 <label for="star2"></label>
						 <input type="radio" name="rating" id="star1" value="1">
						 <label for="star1"></label>
					</div>
                    <input type="hidden" name="url" value="{{ request.get_full_path }}">
                    <input disabled type="submit" name="sending" value="Rating..." id="sending" hidden>
					<input type="submit" value="Rate" id="submit" style="margin-top: 20px;margin-bottom: 10px;">
                </form>
            </div>
		</fieldset>
	</aside>

	<section>
		<fieldset>
			{% include 'media_details.html' %}
		</fieldset>
	</section>

{% if episodes %}
<section>
		<fieldset>
			<legend>Episodes</legend><br>
				{% for episode in episodes %}
					<a href="{% url 'streaming:display_episode' title=media.title season_number=episode.part_of.season_number episode_number=episode.episode_number %}"
					   style="text-decoration: underline;">Season {{ episode.part_of.season_number }} Episode {{ episode.episode_number }} {{ episode.title }}</a><br><br>
				{% endfor %}
	</fieldset>
</section>
{% endif %}

	<section>
		<fieldset>
			{% include "comment.html" %}
		</fieldset>
	</section>

{% endblock %}
